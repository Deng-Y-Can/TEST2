<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Candy å¯¼èˆª</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <!-- å¼•å…¥SheetJSåº“ç”¨äºè¯»å–Excel -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <!-- å¼•å…¥GSAPåŠ¨ç”»åº“ -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    :root {
      --neon-pink: #ff00ff;
      --neon-blue: #00ffff;
      --neon-green: #00ff9d;
      --neon-yellow: #ffff00;
      --neon-purple: #9d00ff;
      --neon-orange: #ff6b00;
      --dark-bg: #0a0014;
      --card-bg: rgba(20, 5, 30, 0.7);
      --glow-pink: 0 0 20px var(--neon-pink), 0 0 40px var(--neon-pink);
      --glow-blue: 0 0 20px var(--neon-blue), 0 0 40px var(--neon-blue);
      --glow-green: 0 0 20px var(--neon-green), 0 0 40px var(--neon-green);
    }
    
    body {
      font-family: 'Segoe UI', system-ui, sans-serif;
      background: var(--dark-bg);
      min-height: 100vh;
      color: white;
      overflow-x: hidden;
      background-image: 
        radial-gradient(circle at 10% 20%, rgba(255, 0, 255, 0.05) 0%, transparent 20%),
        radial-gradient(circle at 90% 40%, rgba(0, 255, 255, 0.05) 0%, transparent 20%),
        radial-gradient(circle at 50% 80%, rgba(0, 255, 157, 0.05) 0%, transparent 20%),
        linear-gradient(45deg, rgba(10, 0, 20, 0.8), rgba(20, 0, 40, 0.8));
    }
    
    /* éœ“è™¹è¾¹æ¡†æ•ˆæœ */
    .neon-border {
      position: relative;
      border: 2px solid transparent;
      background: linear-gradient(var(--card-bg), var(--card-bg)) padding-box,
                  linear-gradient(45deg, var(--neon-pink), var(--neon-blue), var(--neon-green)) border-box;
      border-radius: 15px;
      box-shadow: 0 0 15px rgba(255, 0, 255, 0.3);
    }
    
    .neon-border:hover {
      box-shadow: var(--glow-pink), 0 0 30px rgba(255, 0, 255, 0.4);
    }
    
    /* éœ“è™¹æ–‡å­—æ•ˆæœ */
    .neon-text {
      color: white;
      text-shadow: 
        0 0 10px var(--neon-pink),
        0 0 20px var(--neon-pink),
        0 0 30px var(--neon-pink);
      animation: neon-flicker 2s infinite alternate;
    }
    
    @keyframes neon-flicker {
      0%, 100% { opacity: 1; text-shadow: 0 0 10px var(--neon-pink), 0 0 20px var(--neon-pink); }
      50% { opacity: 0.9; text-shadow: 0 0 15px var(--neon-pink), 0 0 25px var(--neon-pink); }
    }
    
    /* ç³–æœå¡ç‰‡æ•ˆæœ */
    .candy-card {
      background: var(--card-bg);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .candy-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transition: left 0.7s;
    }
    
    .candy-card:hover {
      transform: translateY(-5px) scale(1.02);
      box-shadow: 
        0 15px 35px rgba(0, 0, 0, 0.5),
        0 0 25px rgba(255, 0, 255, 0.3);
    }
    
    .candy-card:hover::before {
      left: 100%;
    }
    
    /* éœ“è™¹æŒ‰é’® */
    .neon-button {
      background: linear-gradient(45deg, var(--neon-pink), var(--neon-purple));
      color: white;
      border: none;
      border-radius: 25px;
      padding: 12px 24px;
      font-weight: bold;
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
      box-shadow: 0 0 15px rgba(255, 0, 255, 0.5);
    }
    
    .neon-button:hover {
      transform: translateY(-3px);
      box-shadow: 
        0 0 25px rgba(255, 0, 255, 0.7),
        0 0 40px rgba(255, 0, 255, 0.3);
    }
    
    .neon-button:active {
      transform: translateY(1px);
    }
    
    /* ç³–æœç‚¹èƒŒæ™¯ */
    .candy-dots {
      background-image: 
        radial-gradient(circle at 10px 10px, var(--neon-pink) 2px, transparent 3px),
        radial-gradient(circle at 30px 30px, var(--neon-blue) 2px, transparent 3px),
        radial-gradient(circle at 50px 50px, var(--neon-green) 2px, transparent 3px);
      background-size: 60px 60px;
      opacity: 0.1;
    }
    
    /* æµ®åŠ¨åŠ¨ç”» */
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-20px); }
    }
    
    @keyframes float2 {
      0%, 100% { transform: translateX(0px) translateY(0px); }
      33% { transform: translateX(20px) translateY(-20px); }
      66% { transform: translateX(-20px) translateY(10px); }
    }
    
    .floating {
      animation: float 6s ease-in-out infinite;
    }
    
    .floating2 {
      animation: float2 8s ease-in-out infinite;
    }
    
    /* è¿›åº¦æ¡æ•ˆæœ */
    .candy-progress {
      height: 4px;
      background: linear-gradient(90deg, var(--neon-pink), var(--neon-blue), var(--neon-green));
      border-radius: 2px;
      position: relative;
      overflow: hidden;
    }
    
    .candy-progress::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.6), transparent);
      animation: shimmer 2s infinite;
    }
    
    @keyframes shimmer {
      0% { left: -100%; }
      100% { left: 100%; }
    }
    
    /* è¾“å…¥æ¡†æ ·å¼ */
    .neon-input {
      background: rgba(20, 5, 30, 0.8);
      border: 2px solid var(--neon-pink);
      border-radius: 12px;
      padding: 12px 16px;
      color: white;
      transition: all 0.3s ease;
      box-shadow: 0 0 10px rgba(255, 0, 255, 0.2);
    }
    
    .neon-input:focus {
      outline: none;
      box-shadow: 0 0 20px rgba(255, 0, 255, 0.5);
      border-color: var(--neon-blue);
    }
    
    /* å¾½ç« æ ·å¼ */
    .candy-badge {
      display: inline-flex;
      align-items: center;
      padding: 4px 12px;
      background: rgba(255, 0, 255, 0.15);
      border: 1px solid var(--neon-pink);
      border-radius: 20px;
      font-size: 12px;
      font-weight: bold;
      color: var(--neon-pink);
      text-shadow: 0 0 5px var(--neon-pink);
    }
    
    /* æ»šåŠ¨æ¡ç¾åŒ– */
    ::-webkit-scrollbar {
      width: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: rgba(20, 5, 30, 0.8);
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb {
      background: linear-gradient(45deg, var(--neon-pink), var(--neon-blue));
      border-radius: 4px;
      box-shadow: 0 0 10px var(--neon-pink);
    }
    
    /* åŠ è½½åŠ¨ç”» */
    .candy-spinner {
      width: 60px;
      height: 60px;
      border: 4px solid rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      border-top: 4px solid var(--neon-pink);
      border-right: 4px solid var(--neon-blue);
      border-bottom: 4px solid var(--neon-green);
      animation: spin 1.5s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* ç³–æœç²’å­ */
    .candy-particle {
      position: fixed;
      border-radius: 50%;
      pointer-events: none;
      z-index: 1;
      filter: blur(2px);
    }
    
    /* å“åº”å¼è®¾è®¡ */
    @media (max-width: 768px) {
      .candy-card:hover {
        transform: translateY(-3px) scale(1.01);
      }
    }
  </style>
</head>

<body>
  <!-- ç³–æœç²’å­èƒŒæ™¯ -->
  <div id="candy-particles"></div>
  
  <!-- è£…é¥°å…ƒç´  -->
  <div class="fixed inset-0 z-0 pointer-events-none">
    <div class="absolute top-1/4 left-1/4 w-64 h-64 bg-gradient-to-r from-pink-500/10 to-blue-500/10 rounded-full blur-3xl floating"></div>
    <div class="absolute bottom-1/4 right-1/4 w-96 h-96 bg-gradient-to-r from-green-500/10 to-purple-500/10 rounded-full blur-3xl floating2"></div>
    <div class="absolute top-3/4 left-3/4 w-48 h-48 bg-gradient-to-r from-yellow-500/10 to-orange-500/10 rounded-full blur-3xl floating" style="animation-delay: 1s;"></div>
  </div>
  
  <!-- ä¸»å®¹å™¨ -->
  <div class="container mx-auto px-4 py-8 relative z-10">
    
    <!-- å¤´éƒ¨åŒºåŸŸ -->
    <header class="mb-12 text-center">
      <div class="inline-block mb-8">
        <!-- éœ“è™¹Logo -->
        <div class="w-24 h-24 mx-auto mb-6 relative">
          <div class="absolute inset-0 bg-gradient-to-r from-pink-500 via-blue-500 to-green-500 rounded-full animate-pulse" style="animation-duration: 2s;"></div>
          <div class="absolute inset-2 bg-gray-900 rounded-full flex items-center justify-center">
            <i class="fa fa-candy-cane text-4xl neon-text"></i>
          </div>
          <div class="absolute -inset-2 bg-gradient-to-r from-pink-500 via-blue-500 to-green-500 rounded-full blur-xl opacity-50"></div>
        </div>
        
        <h1 class="text-6xl md:text-7xl font-bold mb-4 neon-text tracking-tighter">
          CANDY NAV
        </h1>
        <p class="text-2xl text-gray-300 mb-6">Candyå¯¼èˆª Â· ç‚«é…·ä½“éªŒ</p>
        
        <!-- è¿›åº¦æ¡ -->
        <div class="max-w-2xl mx-auto mt-8">
          <div class="candy-progress"></div>
        </div>
      </div>
    </header>
    
    <div class="flex flex-col lg:flex-row gap-8">
      
      <!-- å·¦ä¾§å¯¼èˆªæ  -->
      <aside class="lg:w-1/4">
        <!-- æ§åˆ¶é¢æ¿ -->
        <div class="candy-card p-6 mb-6 neon-border">
          <div class="flex items-center justify-between mb-6">
            <h2 class="text-2xl font-bold flex items-center">
              <i class="fa fa-list mr-3" style="color: var(--neon-pink); text-shadow: var(--glow-pink);"></i>
              <span class="neon-text">å¯¼èˆªåˆ†ç±»</span>
            </h2>
            <div class="flex space-x-2">
              <button id="toggle-effects" class="candy-badge px-3 py-2 hover:bg-pink-500/30 transition-colors" title="ç‰¹æ•ˆå¼€å…³">
                <i class="fa fa-magic"></i>
              </button>
              <button id="toggle-sound" class="candy-badge px-3 py-2 hover:bg-blue-500/30 transition-colors" title="éŸ³æ•ˆå¼€å…³">
                <i class="fa fa-volume-up"></i>
              </button>
            </div>
          </div>
          
          <!-- æœç´¢æ¡† -->
          <div class="relative mb-6">
            <input type="text" id="search-input" placeholder="æœç´¢ç³–æœç«™ç‚¹..." 
                   class="neon-input w-full pl-12">
            <i class="fa fa-search absolute left-4 top-1/2 -translate-y-1/2" style="color: var(--neon-pink); text-shadow: var(--glow-pink);"></i>
          </div>
          
          <!-- åˆ†ç±»åˆ—è¡¨ -->
          <div class="max-h-[400px] overflow-y-auto pr-2 mb-6">
            <h3 class="text-sm font-bold mb-3 uppercase tracking-wider" style="color: var(--neon-blue); text-shadow: var(--glow-blue);">ç³–æœåˆ†ç±»</h3>
            <ul id="category-list" class="space-y-3">
              <!-- åˆ†ç±»å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
            </ul>
          </div>
          
          <!-- æ•°æ®ç»Ÿè®¡ -->
          <div class="candy-card p-4">
            <div class="grid grid-cols-2 gap-4">
              <div class="text-center p-4 rounded-xl" style="background: rgba(255, 0, 255, 0.1); border: 1px solid rgba(255, 0, 255, 0.3);">
                <div class="text-3xl font-bold mb-1" id="total-sites" style="color: var(--neon-pink); text-shadow: var(--glow-pink);">0</div>
                <div class="text-sm" style="color: var(--neon-blue);">æ€»ç«™ç‚¹</div>
              </div>
              <div class="text-center p-4 rounded-xl" style="background: rgba(0, 255, 255, 0.1); border: 1px solid rgba(0, 255, 255, 0.3);">
                <div class="text-3xl font-bold mb-1" id="total-categories" style="color: var(--neon-blue); text-shadow: var(--glow-blue);">0</div>
                <div class="text-sm" style="color: var(--neon-green);">åˆ†ç±»æ•°</div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- å¿«æ·æ“ä½œ -->
        <div class="candy-card p-6 neon-border">
          <h3 class="text-xl font-bold mb-4 flex items-center">
            <i class="fa fa-bolt mr-3" style="color: var(--neon-green); text-shadow: var(--glow-green);"></i>
            <span class="neon-text">å¿«æ·æ“ä½œ</span>
          </h3>
          <div class="space-y-3">
            <button id="refresh-btn" class="w-full neon-button">
              <i class="fa fa-sync-alt mr-3"></i>
              åˆ·æ–°æ•°æ®
            </button>
            <button id="favorites-btn" class="w-full neon-button relative" style="background: linear-gradient(45deg, var(--neon-yellow), var(--neon-orange));">
              <i class="fa fa-star mr-3"></i>
              æˆ‘çš„æ”¶è—
              <span id="favorites-count" class="absolute -top-2 -right-2 bg-gradient-to-r from-pink-500 to-purple-500 text-white text-xs rounded-full w-6 h-6 flex items-center justify-center neon-text">0</span>
            </button>
            <button id="random-site" class="w-full neon-button" style="background: linear-gradient(45deg, var(--neon-purple), var(--neon-pink));">
              <i class="fa fa-random mr-3"></i>
              éšæœºç«™ç‚¹
            </button>
          </div>
        </div>
      </aside>
      
      <!-- å³ä¾§å†…å®¹åŒº -->
      <section class="lg:w-3/4">
        <!-- é¡¶éƒ¨æ§åˆ¶æ  -->
        <div class="candy-card p-6 mb-6 neon-border">
          <div class="flex flex-wrap justify-between items-center">
            <div>
              <h2 id="category-title" class="text-3xl font-bold flex items-center">
                <i class="fa fa-globe mr-3" style="color: var(--neon-blue); text-shadow: var(--glow-blue);"></i>
                <span class="neon-text">æ‰€æœ‰ç³–æœç«™ç‚¹</span>
              </h2>
              <p class="text-gray-300 mt-2">å‘ç° <span id="display-count" class="font-bold text-white">0</span> ä¸ªç¾å‘³ç«™ç‚¹</p>
            </div>
            
            <div class="flex items-center space-x-4 mt-4 lg:mt-0">
              <!-- æ’åº -->
              <div class="relative">
                <select id="sort-select" class="neon-input appearance-none pr-10">
                  <option value="name-asc">ğŸ¬ åç§°æ’åº</option>
                  <option value="name-desc">ğŸ”¥ åç§°å€’åº</option>
                  <option value="random">ğŸ² éšæœºæ’åº</option>
                </select>
                <i class="fa fa-sort absolute right-3 top-1/2 -translate-y-1/2" style="color: var(--neon-pink);"></i>
              </div>
              
              <!-- è§†å›¾åˆ‡æ¢ -->
              <div class="flex bg-gray-900/50 rounded-xl p-1">
                <button class="view-toggle px-3 py-2 rounded-lg transition-colors bg-gradient-to-r from-pink-500 to-purple-500" data-view="grid">
                  <i class="fa fa-th-large"></i>
                </button>
                <button class="view-toggle px-3 py-2 rounded-lg transition-colors hover:bg-gray-800/50" data-view="list">
                  <i class="fa fa-list"></i>
                </button>
                <button class="view-toggle px-3 py-2 rounded-lg transition-colors hover:bg-gray-800/50" data-view="compact">
                  <i class="fa fa-th"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- ç½‘ç«™ç½‘æ ¼ -->
        <div id="website-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          <!-- ç½‘ç«™å¡ç‰‡å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
          <div class="col-span-full flex justify-center items-center py-20">
            <div class="text-center">
              <div class="candy-spinner mx-auto mb-6"></div>
              <p class="text-lg mb-2 neon-text">æ­£åœ¨åŠ è½½ç³–æœæ•°æ®...</p>
              <p class="text-gray-400">è¯·ç¨å€™</p>
            </div>
          </div>
        </div>
        
        <!-- åˆ†é¡µ -->
        <div id="pagination" class="mt-8 flex justify-center items-center space-x-4 hidden">
          <button id="prev-page" class="neon-button px-6 py-3 disabled:opacity-50 disabled:cursor-not-allowed">
            <i class="fa fa-chevron-left mr-2"></i>ä¸Šä¸€é¡µ
          </button>
          <div class="candy-card px-6 py-3 neon-border">
            ç¬¬ <span id="current-page" class="font-bold" style="color: var(--neon-pink);">1</span> / 
            <span id="total-pages" class="font-bold" style="color: var(--neon-blue);">1</span> é¡µ
          </div>
          <button id="next-page" class="neon-button px-6 py-3 disabled:opacity-50 disabled:cursor-not-allowed">
            ä¸‹ä¸€é¡µ<i class="fa fa-chevron-right ml-2"></i>
          </button>
        </div>
      </section>
    </div>
  </div>
  
  <!-- æ”¶è—å¤¹æ¨¡æ€æ¡† -->
  <div id="favorites-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden opacity-0 transition-opacity duration-300">
    <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="closeFavorites()"></div>
    <div class="relative candy-card w-full max-w-4xl max-h-[80vh] flex flex-col transform scale-95 transition-transform duration-300 neon-border">
      <div class="p-6 border-b border-gray-700 flex justify-between items-center">
        <h3 class="text-2xl font-bold flex items-center">
          <i class="fa fa-star mr-3" style="color: var(--neon-yellow); text-shadow: 0 0 10px var(--neon-yellow);"></i>
          <span class="neon-text">æˆ‘çš„ç³–æœæ”¶è—</span>
        </h3>
        <button onclick="closeFavorites()" class="candy-badge px-3 py-2 hover:bg-red-500/30">
          <i class="fa fa-times"></i>
        </button>
      </div>
      <div id="favorites-container" class="p-6 overflow-y-auto flex-grow">
        <!-- æ”¶è—å†…å®¹å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
        <div class="text-center py-12">
          <i class="fa fa-star text-6xl mb-4" style="color: rgba(255, 255, 255, 0.1);"></i>
          <p class="text-gray-300 mb-2">è¿˜æ²¡æœ‰æ”¶è—ä»»ä½•ç³–æœç«™ç‚¹</p>
          <p class="text-sm text-gray-400">ç‚¹å‡»ç½‘ç«™å¡ç‰‡ä¸Šçš„æ˜Ÿæ˜Ÿå›¾æ ‡æ·»åŠ æ”¶è—</p>
        </div>
      </div>
      <div class="p-4 border-t border-gray-700 text-center">
        <button id="clear-favorites" class="neon-button px-6 py-3" style="background: linear-gradient(45deg, #ff0000, #ff6b00);">
          <i class="fa fa-trash mr-2"></i>æ¸…ç©ºæ”¶è—å¤¹
        </button>
      </div>
    </div>
  </div>
  
  <!-- åº•éƒ¨ä¿¡æ¯ -->
  <footer class="mt-12 pt-8 border-t border-gray-800 text-center text-gray-300">
    <div class="container mx-auto px-4">
      <p class="mb-4">ğŸ¬ Candy å¯¼èˆª &copy; 2025 | éœ“è™¹ç³–æœï¼Œç¾å‘³å¯¼èˆª</p>
      <p class="text-sm opacity-75">æ•°æ®æ¥æºï¼šç½‘ç«™å¯¼èˆª.xlsx | éœ“è™¹ç‰¹æ•ˆ Powered by CSS & GSAP</p>
    </div>
  </footer>

  <script>
    // å…¨å±€å˜é‡
    let allWebsites = [];
    let filteredWebsites = [];
    let currentCategory = 'all';
    let favorites = JSON.parse(localStorage.getItem('candyNeonFavorites')) || [];
    let currentPage = 1;
    let itemsPerPage = 12;
    let currentView = 'grid';
    let isEffectsEnabled = true;
    
    // éœ“è™¹é¢œè‰²é…ç½®
    const neonColors = [
      '#ff00ff', // pink
      '#00ffff', // blue
      '#00ff9d', // green
      '#ffff00', // yellow
      '#9d00ff', // purple
      '#ff6b00', // orange
      '#ff009d', // magenta
      '#00ffcc', // cyan
    ];
    
    // DOMå…ƒç´ 
    const categoryListEl = document.getElementById('category-list');
    const websiteContainerEl = document.getElementById('website-container');
    const categoryTitleEl = document.getElementById('category-title');
    const displayCountEl = document.getElementById('display-count');
    const searchInputEl = document.getElementById('search-input');
    const favoritesBtn = document.getElementById('favorites-btn');
    const favoritesCountEl = document.getElementById('favorites-count');
    const favoritesModal = document.getElementById('favorites-modal');
    const favoritesContainer = document.getElementById('favorites-container');
    const clearFavoritesBtn = document.getElementById('clear-favorites');
    const sortSelectEl = document.getElementById('sort-select');
    const viewToggles = document.querySelectorAll('.view-toggle');
    const refreshBtn = document.getElementById('refresh-btn');
    const randomSiteBtn = document.getElementById('random-site');
    const totalSitesEl = document.getElementById('total-sites');
    const totalCategoriesEl = document.getElementById('total-categories');
    const toggleEffectsBtn = document.getElementById('toggle-effects');
    const toggleSoundBtn = document.getElementById('toggle-sound');
    const paginationEl = document.getElementById('pagination');
    const prevPageBtn = document.getElementById('prev-page');
    const nextPageBtn = document.getElementById('next-page');
    const currentPageEl = document.getElementById('current-page');
    const totalPagesEl = document.getElementById('total-pages');
    
    // åˆ›å»ºç³–æœç²’å­æ•ˆæœ
    function createCandyParticles() {
      const container = document.getElementById('candy-particles');
      const particleCount = 30;
      
      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.className = 'candy-particle';
        
        // éšæœºå¤§å°
        const size = Math.random() * 15 + 5;
        particle.style.width = `${size}px`;
        particle.style.height = `${size}px`;
        
        // éšæœºä½ç½®
        particle.style.left = `${Math.random() * 100}vw`;
        particle.style.top = `${Math.random() * 100}vh`;
        
        // éšæœºé¢œè‰²
        const color1 = neonColors[Math.floor(Math.random() * neonColors.length)];
        const color2 = neonColors[Math.floor(Math.random() * neonColors.length)];
        particle.style.background = `radial-gradient(circle at center, ${color1}, ${color2})`;
        
        // éšæœºåŠ¨ç”»
        const duration = Math.random() * 15 + 10;
        const delay = Math.random() * 5;
        particle.style.animation = `float ${duration}s ease-in-out ${delay}s infinite`;
        particle.style.opacity = Math.random() * 0.3 + 0.1;
        
        container.appendChild(particle);
      }
    }
    
    // åˆ‡æ¢ç‰¹æ•ˆ
    function toggleEffects() {
      isEffectsEnabled = !isEffectsEnabled;
      const elements = document.querySelectorAll('.neon-text, .neon-border, .neon-button');
      
      if (isEffectsEnabled) {
        elements.forEach(el => {
          el.style.animationPlayState = 'running';
          el.style.filter = 'none';
        });
        showToast('ğŸ‰ éœ“è™¹ç‰¹æ•ˆå·²å¼€å¯', 'success');
        toggleEffectsBtn.innerHTML = '<i class="fa fa-magic"></i>';
      } else {
        elements.forEach(el => {
          el.style.animationPlayState = 'paused';
          el.style.filter = 'grayscale(1)';
        });
        showToast('ğŸ’¡ éœ“è™¹ç‰¹æ•ˆå·²å…³é—­', 'info');
        toggleEffectsBtn.innerHTML = '<i class="fa fa-ban"></i>';
      }
    }
    
    // éšæœºè®¿é—®ä¸€ä¸ªç½‘ç«™
    function visitRandomSite() {
      if (allWebsites.length === 0) return;
      
      const randomSite = allWebsites[Math.floor(Math.random() * allWebsites.length)];
      showToast(`ğŸ² éšæœºè®¿é—®: ${randomSite.name}`, 'success');
      
      // æ·»åŠ ç‚¹å‡»æ•ˆæœ
      gsap.to(randomSiteBtn, {
        scale: 1.2,
        rotation: 360,
        duration: 0.5,
        ease: 'back.out(1.7)',
        onComplete: () => {
          setTimeout(() => {
            window.open(randomSite.web, '_blank');
          }, 500);
        }
      });
    }
    
    // åˆå§‹åŒ–
    async function init() {
      try {
        // åˆ›å»ºç³–æœç²’å­
        createCandyParticles();
        
        // åŠ è½½Excelæ•°æ®
        await loadExcelData();
        
        // æ›´æ–°æ”¶è—è®¡æ•°
        updateFavoritesCount();
        
        // æ·»åŠ äº‹ä»¶ç›‘å¬
        addEventListeners();
        
        // åˆå§‹åŠ¨ç”»
        gsap.from('header', {
          y: -50,
          opacity: 0,
          duration: 1,
          ease: 'power3.out'
        });
        
        gsap.from('aside', {
          x: -50,
          opacity: 0,
          duration: 1,
          delay: 0.2,
          ease: 'power3.out'
        });
        
        gsap.from('section', {
          x: 50,
          opacity: 0,
          duration: 1,
          delay: 0.4,
          ease: 'power3.out'
        });
        
      } catch (error) {
        console.error('åˆå§‹åŒ–å¤±è´¥:', error);
        showError('åˆå§‹åŒ–å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–æ–‡ä»¶æ ¼å¼');
      }
    }
    
    // åŠ è½½Excelæ•°æ®
    async function loadExcelData() {
      try {
        websiteContainerEl.innerHTML = `
          <div class="col-span-full flex justify-center items-center py-20">
            <div class="text-center">
              <div class="candy-spinner mx-auto mb-6"></div>
              <p class="text-lg mb-2 neon-text">æ­£åœ¨åŠ è½½ç³–æœæ•°æ®...</p>
              <p class="text-gray-400">è¯·ç¨å€™</p>
            </div>
          </div>
        `;
        
        const response = await fetch('ç½‘ç«™å¯¼èˆª.xlsx');
        
        if (!response.ok) {
          throw new Error(`HTTPé”™è¯¯: ${response.status} - è¯·ç¡®ä¿"ç½‘ç«™å¯¼èˆª.xlsx"æ–‡ä»¶å­˜åœ¨`);
        }
        
        const arrayBuffer = await response.arrayBuffer();
        const workbook = XLSX.read(arrayBuffer, { type: 'array' });
        
        // è·å–ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨
        const firstSheetName = workbook.SheetNames[0];
        const worksheet = workbook.Sheets[firstSheetName];
        
        // å°†å·¥ä½œè¡¨è½¬æ¢ä¸ºJSON
        const excelData = XLSX.utils.sheet_to_json(worksheet);
        
        // å¤„ç†Excelæ•°æ®
        allWebsites = excelData.map(row => {
          const name = row['åç§°'] || row['ç½‘ç«™åç§°'] || row['name'] || row['ç½‘ç«™'] || '';
          const web = row['ç½‘å€'] || row['ç½‘ç«™é“¾æ¥'] || row['url'] || row['web'] || row['é“¾æ¥'] || '';
          const type = row['åˆ†ç±»'] || row['ç±»åˆ«'] || row['type'] || row['category'] || 'æœªåˆ†ç±»';
          const remark = row['å¤‡æ³¨'] || row['æè¿°'] || row['remark'] || row['description'] || row['ä»‹ç»'] || '';
          
          return { name, web, type, remark };
        }).filter(item => item.name && item.web);
        
        if (allWebsites.length === 0) {
          throw new Error('Excelæ–‡ä»¶ä¸­æ²¡æœ‰æœ‰æ•ˆæ•°æ®');
        }
        
        filteredWebsites = [...allWebsites];
        
        // æå–æ‰€æœ‰åˆ†ç±»
        const categories = ['all', ...new Set(allWebsites.map(item => item.type))];
        
        // æ¸²æŸ“åˆ†ç±»åˆ—è¡¨
        renderCategories(categories);
        
        // ç­›é€‰å¹¶æ¸²æŸ“ç½‘ç«™
        filterAndRenderWebsites();
        
        // æ›´æ–°ç»Ÿè®¡æ•°æ®
        updateStats();
        
        // æ˜¾ç¤ºæˆåŠŸæç¤º
        showToast('ğŸ¬ ç³–æœæ•°æ®åŠ è½½æˆåŠŸï¼', 'success');
        
      } catch (error) {
        console.error('åŠ è½½Excelæ•°æ®å¤±è´¥:', error);
        
        websiteContainerEl.innerHTML = `
          <div class="col-span-full flex justify-center items-center py-20">
            <div class="text-center">
              <i class="fa fa-exclamation-triangle text-5xl mb-4" style="color: var(--neon-pink); text-shadow: var(--glow-pink);"></i>
              <p class="text-lg mb-2">æ•°æ®åŠ è½½å¤±è´¥</p>
              <p class="text-gray-300 mb-6">${error.message}</p>
              <button onclick="location.reload()" class="neon-button px-6 py-3">
                é‡æ–°åŠ è½½
              </button>
            </div>
          </div>
        `;
      }
    }
    
    // æ¸²æŸ“åˆ†ç±»åˆ—è¡¨
    function renderCategories(categories) {
      categoryListEl.innerHTML = '';
      
      categories.forEach(category => {
        const li = document.createElement('li');
        const isActive = currentCategory === category;
        const color = neonColors[Math.floor(Math.random() * neonColors.length)];
        
        li.className = `candy-card p-4 cursor-pointer transition-all duration-300 ${
          isActive ? 'scale-105' : ''
        }`;
        
        li.innerHTML = `
          <div class="flex items-center">
            <div class="w-10 h-10 rounded-full flex items-center justify-center mr-3" 
                 style="background: ${color}30; border: 2px solid ${color}60; box-shadow: 0 0 10px ${color}40;">
              <i class="fa ${category === 'all' ? 'fa-globe' : 'fa-folder'}" style="color: ${color}"></i>
            </div>
            <span class="font-bold text-lg">${category === 'all' ? 'æ‰€æœ‰ç³–æœ' : category}</span>
            ${isActive ? '<div class="ml-auto w-3 h-3 rounded-full animate-pulse" style="background: ' + color + '; box-shadow: 0 0 10px ' + color + ';"></div>' : ''}
          </div>
        `;
        
        li.addEventListener('click', () => {
          currentCategory = category;
          currentPage = 1;
          
          // æ›´æ–°åˆ†ç±»æ ‡é¢˜
          categoryTitleEl.innerHTML = `
            <i class="fa fa-globe mr-3" style="color: ${color}; text-shadow: 0 0 10px ${color};"></i>
            <span class="neon-text">${category === 'all' ? 'æ‰€æœ‰ç³–æœç«™ç‚¹' : category}</span>
          `;
          
          // æ›´æ–°æ¿€æ´»çŠ¶æ€
          document.querySelectorAll('#category-list li').forEach(item => {
            item.classList.remove('scale-105');
          });
          
          li.classList.add('scale-105');
          
          // ç­›é€‰å¹¶æ¸²æŸ“ç½‘ç«™
          filterAndRenderWebsites();
          
          // åŠ¨ç”»æ•ˆæœ
          gsap.to(li, {
            scale: 1.1,
            duration: 0.3,
            yoyo: true,
            repeat: 1
          });
        });
        
        categoryListEl.appendChild(li);
      });
    }
    
    // æ¸²æŸ“ç½‘ç«™åˆ—è¡¨
    function renderWebsites(websites) {
      if (websites.length === 0) {
        websiteContainerEl.innerHTML = `
          <div class="col-span-full flex justify-center items-center py-20">
            <div class="text-center">
              <i class="fa fa-search text-5xl mb-4" style="color: rgba(255,255,255,0.3);"></i>
              <p class="text-lg mb-2">æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„ç³–æœç«™ç‚¹</p>
              <button id="clear-filters-btn" class="neon-button px-6 py-3 mt-4">
                æ¸…é™¤ç­›é€‰
              </button>
            </div>
          </div>
        `;
        
        document.getElementById('clear-filters-btn')?.addEventListener('click', () => {
          currentCategory = 'all';
          searchInputEl.value = '';
          const categories = ['all', ...new Set(allWebsites.map(item => item.type))];
          renderCategories(categories);
          categoryTitleEl.innerHTML = `<i class="fa fa-globe mr-3" style="color: var(--neon-blue);"></i><span class="neon-text">æ‰€æœ‰ç³–æœç«™ç‚¹</span>`;
          currentPage = 1;
          filterAndRenderWebsites();
        });
        
        paginationEl.classList.add('hidden');
        return;
      }
      
      // è®¡ç®—åˆ†é¡µ
      const totalPages = Math.ceil(websites.length / itemsPerPage);
      const startIndex = (currentPage - 1) * itemsPerPage;
      const endIndex = startIndex + itemsPerPage;
      const pagedWebsites = websites.slice(startIndex, endIndex);
      
      // æ›´æ–°åˆ†é¡µä¿¡æ¯
      if (websites.length > itemsPerPage) {
        paginationEl.classList.remove('hidden');
        currentPageEl.textContent = currentPage;
        totalPagesEl.textContent = totalPages;
        
        prevPageBtn.disabled = currentPage === 1;
        nextPageBtn.disabled = currentPage === totalPages;
      } else {
        paginationEl.classList.add('hidden');
      }
      
      // æ¸…ç©ºå®¹å™¨
      websiteContainerEl.innerHTML = '';
      
      // æ ¹æ®è§†å›¾æ¨¡å¼æ¸²æŸ“ç½‘ç«™
      pagedWebsites.forEach((website, index) => {
        const card = createWebsiteCard(website, index);
        websiteContainerEl.appendChild(card);
      });
      
      // æ·»åŠ å¡ç‰‡å…¥åœºåŠ¨ç”»
      gsap.from('.website-card', {
        y: 50,
        opacity: 0,
        duration: 0.6,
        stagger: 0.1,
        ease: 'power3.out'
      });
    }
    
    // åˆ›å»ºç½‘ç«™å¡ç‰‡
    function createWebsiteCard(website, index) {
      const isFavorite = favorites.some(fav => fav.web === website.web);
      const color = neonColors[index % neonColors.length];
      
      const card = document.createElement('div');
      card.className = `website-card candy-card neon-border ${
        currentView === 'list' ? 'md:col-span-2' : currentView === 'compact' ? '' : ''
      }`;
      
      // æå–åŸŸå
      let domain = '';
      try {
        let urlStr = website.web;
        if (!urlStr.startsWith('http://') && !urlStr.startsWith('https://')) {
          urlStr = 'https://' + urlStr;
        }
        const url = new URL(urlStr);
        domain = url.hostname.replace('www.', '');
      } catch (e) {
        domain = website.web;
      }
      
      card.innerHTML = `
        <div class="p-6">
          <div class="flex items-start justify-between mb-4">
            <div class="flex items-center">
              <div class="w-14 h-14 rounded-full flex items-center justify-center mr-4" 
                   style="background: ${color}20; border: 2px solid ${color}60; box-shadow: 0 0 15px ${color}40;">
                <i class="fa fa-link text-xl" style="color: ${color}"></i>
              </div>
              <div>
                <h3 class="text-xl font-bold mb-2">
                  <a href="${website.web}" target="_blank" rel="noopener noreferrer" 
                     class="hover:opacity-80 transition-opacity" style="color: ${color}; text-shadow: 0 0 10px ${color}">
                    ${website.name}
                  </a>
                </h3>
                <p class="text-sm" style="color: ${color}aa">${domain}</p>
              </div>
            </div>
            <button class="favorite-btn candy-badge hover:scale-110 transition-transform ${
              isFavorite ? 'animate-pulse' : ''
            }" data-web="${website.web}" style="border-color: ${color}; background: ${color}20;">
              <i class="fa ${isFavorite ? 'fa-star' : 'fa-star-o'}" style="color: ${isFavorite ? color : '#ffffffaa'}"></i>
            </button>
          </div>
          
          <div class="mb-4">
            <span class="inline-block px-4 py-2 rounded-full text-sm font-bold" 
                  style="background: ${color}15; color: ${color}; border: 1px solid ${color}40;">
              ${website.type}
            </span>
          </div>
          
          <p class="text-gray-300 mb-6 line-clamp-2">${website.remark || 'è¿™æ˜¯ä¸€ä¸ªç¾å‘³çš„ç³–æœç«™ç‚¹ï¼Œç­‰å¾…æ‚¨çš„æ¢ç´¢...'}</p>
          
          <div class="flex items-center justify-between">
            <a href="${website.web}" target="_blank" rel="noopener noreferrer" 
               class="neon-button text-sm px-4 py-2" style="background: linear-gradient(45deg, ${color}, ${neonColors[(index + 1) % neonColors.length]})">
              ğŸ­ ç«‹å³å“å°
            </a>
            <div class="text-xs opacity-50 flex items-center">
              <i class="fa fa-heart mr-1" style="color: ${color}"></i>
              <span>ç³–æœçƒ­åº¦</span>
            </div>
          </div>
        </div>
      `;
      
      // æ”¶è—æŒ‰é’®äº‹ä»¶
      card.querySelector('.favorite-btn').addEventListener('click', (e) => {
        e.preventDefault();
        e.stopPropagation();
        toggleFavorite(website, e.target.closest('.favorite-btn'));
      });
      
      return card;
    }
    
    // åˆ‡æ¢æ”¶è—çŠ¶æ€
    function toggleFavorite(website, btn) {
      const index = favorites.findIndex(fav => fav.web === website.web);
      
      if (index === -1) {
        // æ·»åŠ æ”¶è—
        favorites.push(website);
        btn.innerHTML = '<i class="fa fa-star"></i>';
        btn.className = btn.className.replace('fa-star-o', 'fa-star') + ' animate-pulse';
        
        // åŠ¨ç”»æ•ˆæœ
        gsap.to(btn, {
          scale: 1.3,
          rotationY: 360,
          duration: 0.5,
          ease: 'back.out(1.7)'
        });
        
        showToast(`â­ å·²æ”¶è—: ${website.name}`, 'success');
      } else {
        // ç§»é™¤æ”¶è—
        favorites.splice(index, 1);
        btn.innerHTML = '<i class="fa fa-star-o"></i>';
        btn.className = btn.className.replace('fa-star', 'fa-star-o').replace('animate-pulse', '');
        
        showToast(`ğŸ’” å·²å–æ¶ˆæ”¶è—: ${website.name}`, 'info');
      }
      
      // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
      localStorage.setItem('candyNeonFavorites', JSON.stringify(favorites));
      
      // æ›´æ–°æ”¶è—è®¡æ•°
      updateFavoritesCount();
      
      // å¦‚æœå½“å‰åœ¨æ”¶è—å¤¹é¡µé¢ï¼Œé‡æ–°æ¸²æŸ“
      if (!favoritesModal.classList.contains('hidden')) {
        renderFavorites();
      }
    }
    
    // æ›´æ–°æ”¶è—è®¡æ•°
    function updateFavoritesCount() {
      const count = favorites.length;
      favoritesCountEl.textContent = count;
      
      // åŠ¨ç”»æ•ˆæœ
      if (count > 0) {
        gsap.to(favoritesCountEl, {
          scale: 1.3,
          duration: 0.2,
          yoyo: true,
          repeat: 1
        });
      }
    }
    
    // ç­›é€‰å¹¶æ¸²æŸ“ç½‘ç«™
    function filterAndRenderWebsites() {
      let result = [...allWebsites];
      
      // æŒ‰åˆ†ç±»ç­›é€‰
      if (currentCategory !== 'all') {
        result = result.filter(website => website.type === currentCategory);
      }
      
      // æŒ‰æœç´¢è¯ç­›é€‰
      const searchTerm = searchInputEl.value.trim().toLowerCase();
      if (searchTerm) {
        result = result.filter(website => 
          website.name.toLowerCase().includes(searchTerm) || 
          website.remark?.toLowerCase().includes(searchTerm) ||
          website.type.toLowerCase().includes(searchTerm) ||
          website.web.toLowerCase().includes(searchTerm)
        );
      }
      
      // æŒ‰æ’åºæ–¹å¼æ’åº
      const sortBy = sortSelectEl.value;
      if (sortBy === 'name-asc') {
        result.sort((a, b) => a.name.localeCompare(b.name));
      } else if (sortBy === 'name-desc') {
        result.sort((a, b) => b.name.localeCompare(a.name));
      } else if (sortBy === 'random') {
        result = shuffleArray(result);
      }
      
      // æ›´æ–°ç­›é€‰ç»“æœ
      filteredWebsites = result;
      
      // æ›´æ–°æ˜¾ç¤ºæ•°é‡
      displayCountEl.textContent = result.length;
      
      // æ¸²æŸ“ç­›é€‰åçš„ç½‘ç«™
      renderWebsites(result);
    }
    
    // éšæœºæ‰“ä¹±æ•°ç»„
    function shuffleArray(array) {
      const shuffled = [...array];
      for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
      }
      return shuffled;
    }
    
    // æ›´æ–°ç»Ÿè®¡æ•°æ®
    function updateStats() {
      const categories = new Set(allWebsites.map(item => item.type));
      
      totalSitesEl.textContent = allWebsites.length;
      totalCategoriesEl.textContent = categories.size;
      
      // æ•°å­—åŠ¨ç”»
      gsap.from([totalSitesEl, totalCategoriesEl], {
        textContent: 0,
        duration: 1.5,
        ease: "power2.out",
        snap: { textContent: 1 },
        stagger: 0.2
      });
    }
    
    // æ˜¾ç¤ºæç¤ºæ¶ˆæ¯
    function showToast(message, type = 'info') {
      const toast = document.createElement('div');
      toast.className = `fixed top-6 right-6 bg-gray-900/90 backdrop-blur-sm rounded-xl px-6 py-4 flex items-center space-x-3 z-50 transform translate-x-full transition-transform duration-300 border-l-4 ${
        type === 'success' ? 'border-green-500' : 
        type === 'error' ? 'border-red-500' : 
        'border-blue-500'
      }`;
      
      let icon = 'fa-info-circle';
      let iconColor = '#00ffff';
      
      if (type === 'success') {
        icon = 'fa-check-circle';
        iconColor = '#00ff9d';
      } else if (type === 'error') {
        icon = 'fa-exclamation-circle';
        iconColor = '#ff0000';
      }
      
      toast.innerHTML = `
        <i class="fa ${icon} text-xl" style="color: ${iconColor}; text-shadow: 0 0 10px ${iconColor};"></i>
        <span>${message}</span>
      `;
      
      document.body.appendChild(toast);
      
      setTimeout(() => {
        toast.classList.remove('translate-x-full');
      }, 10);
      
      setTimeout(() => {
        toast.classList.add('translate-x-full');
        setTimeout(() => toast.remove(), 300);
      }, 3000);
    }
    
    // æ·»åŠ äº‹ä»¶ç›‘å¬
    function addEventListeners() {
      // æœç´¢æ¡†äº‹ä»¶
      searchInputEl.addEventListener('input', () => {
        currentPage = 1;
        filterAndRenderWebsites();
      });
      
      // æ’åºé€‰æ‹©äº‹ä»¶
      sortSelectEl.addEventListener('change', () => {
        currentPage = 1;
        filterAndRenderWebsites();
      });
      
      // è§†å›¾åˆ‡æ¢äº‹ä»¶
      viewToggles.forEach(toggle => {
        toggle.addEventListener('click', () => {
          viewToggles.forEach(t => {
            t.className = t.className.replace('bg-gradient-to-r from-pink-500 to-purple-500', '');
            t.className += ' hover:bg-gray-800/50';
          });
          toggle.className = toggle.className.replace('hover:bg-gray-800/50', '') + ' bg-gradient-to-r from-pink-500 to-purple-500';
          
          currentView = toggle.dataset.view;
          
          // æ›´æ–°ç½‘ç«™å®¹å™¨ç±»
          websiteContainerEl.className = '';
          if (currentView === 'grid') {
            websiteContainerEl.classList.add('grid', 'grid-cols-1', 'md:grid-cols-2', 'lg:grid-cols-3', 'gap-6');
          } else if (currentView === 'list') {
            websiteContainerEl.classList.add('grid', 'grid-cols-1', 'gap-6');
          } else if (currentView === 'compact') {
            websiteContainerEl.classList.add('grid', 'grid-cols-2', 'md:grid-cols-3', 'lg:grid-cols-4', 'gap-4');
          }
          
          // é‡æ–°æ¸²æŸ“
          if (filteredWebsites.length > 0) {
            renderWebsites(filteredWebsites);
          }
        });
      });
      
      // åˆ†é¡µæŒ‰é’®äº‹ä»¶
      prevPageBtn.addEventListener('click', () => {
        if (currentPage > 1) {
          currentPage--;
          renderWebsites(filteredWebsites);
        }
      });
      
      nextPageBtn.addEventListener('click', () => {
        const totalPages = Math.ceil(filteredWebsites.length / itemsPerPage);
        if (currentPage < totalPages) {
          currentPage++;
          renderWebsites(filteredWebsites);
        }
      });
      
      // éšæœºç«™ç‚¹æŒ‰é’®
      randomSiteBtn.addEventListener('click', visitRandomSite);
      
      // ç‰¹æ•ˆå¼€å…³
      toggleEffectsBtn.addEventListener('click', toggleEffects);
      
      // åˆ·æ–°æŒ‰é’®äº‹ä»¶
      refreshBtn.addEventListener('click', () => {
        showToast('æ­£åœ¨åˆ·æ–°ç³–æœæ•°æ®...', 'info');
        loadExcelData();
      });
    }
    
    // å¯åŠ¨åº”ç”¨
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>